# ============================================
# LifeBox IoT Platform - Production Configuration
# ============================================
# 
# IMPORTANT: Copy this to .env and fill in real values for production
# NEVER commit .env files with actual secrets to version control
# 
# For VPS deployment guide, see: docs/DEPLOYMENT.md
# ============================================

# =============================================================================
# üåê VPS & DOMAIN CONFIGURATION
# =============================================================================

# Your VPS Public IP and Domain (REQUIRED)
VPS_PUBLIC_IP=YOUR_VPS_IP_HERE
DOMAIN=your-domain.com

# =============================================================================
# üóÑÔ∏è PRODUCTION DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL/TimescaleDB Configuration (REQUIRED)
DATABASE_URL="postgresql://lifebox_prod:STRONG_DB_PASSWORD@localhost:5432/lifebox_production?schema=public"
DB_USERNAME=lifebox_prod
DB_PASSWORD=STRONG_DB_PASSWORD_HERE
DB_DATABASE=lifebox_production

# =============================================================================
# üîê SECURITY CONFIGURATION - PRODUCTION
# =============================================================================

# JWT Authentication - GENERATE STRONG SECRETS
JWT_SECRET="GENERATE_STRONG_JWT_SECRET_256_BITS_MINIMUM"
JWT_EXPIRATION="24h"
JWT_REFRESH_SECRET="GENERATE_STRONG_REFRESH_SECRET_256_BITS_MINIMUM"
JWT_REFRESH_EXPIRATION="7d"

# Session Security
SESSION_SECRET="GENERATE_STRONG_SESSION_SECRET_256_BITS_MINIMUM"

# API Admin Tokens - Service-to-service communication
API_ADMIN_TOKEN="GENERATE_STRONG_API_ADMIN_TOKEN"
MQTT_API_TOKEN="GENERATE_STRONG_MQTT_TOKEN"

# Webhook Security
WEBHOOK_SECRET="GENERATE_STRONG_WEBHOOK_SECRET"
INTEGRATION_API_KEY="GENERATE_STRONG_INTEGRATION_KEY"

# =============================================================================
# üèóÔ∏è APPLICATION CONFIGURATION
# =============================================================================

# Environment & API
NODE_ENV=production
PORT=3000
API_PORT=3000
API_PREFIX="api/v1"

# URLs
FRONTEND_URL=https://your-domain.com
NEXT_PUBLIC_API_URL="https://your-domain.com/api/v1"
NEXT_PUBLIC_WS_URL="wss://your-domain.com"

# =============================================================================
# üì° MQTT BROKER CONFIGURATION - PRODUCTION
# =============================================================================

# MQTT Broker Settings
MQTT_BROKER_HOST=emqx
MQTT_BROKER_PORT=1883
MQTT_USERNAME=lifebox_mqtt_prod
MQTT_PASSWORD=STRONG_MQTT_PASSWORD_HERE
MQTT_CLIENT_ID=lifebox-production

# EMQX Dashboard
EMQX_DASHBOARD_USER=admin
EMQX_DASHBOARD_PASSWORD=STRONG_EMQX_DASHBOARD_PASSWORD

# MQTT Topics
MQTT_TELEMETRY_TOPIC="lifebox/devices/+/telemetry"
MQTT_STATUS_TOPIC="lifebox/devices/+/status"
MQTT_COMMAND_TOPIC="lifebox/devices/+/commands"
MQTT_ALARM_TOPIC="lifebox/devices/+/alarms"

# MQTT Processing
CONCURRENT_PROCESSING=10
API_TIMEOUT=30000

# =============================================================================
# üí≥ FAWRY PAYMENT GATEWAY - PRODUCTION
# =============================================================================

# Fawry Production Configuration (GET FROM FAWRY)
FAWRY_BASE_URL="https://atfawry.fawrystaging.com"  # Change to production URL
FAWRY_MERCHANT_CODE="YOUR_PRODUCTION_MERCHANT_CODE"
FAWRY_SECURITY_KEY="YOUR_PRODUCTION_SECURITY_KEY"
FAWRY_BILL_TYPE_CODE="YOUR_BILL_TYPE_CODE"
FAWRY_SKIP_SIGNATURE_VALIDATION=false
FAWRY_WEBHOOK_URL="https://your-domain.com/api/v1/fawry/webhook"
FAWRY_PAYMENT_EXPIRY_HOURS=48
FAWRY_TIMEOUT=30000
FAWRY_RETRIES=3

# Credit Monitoring Thresholds (EGP)
CREDIT_WARNING_THRESHOLD=100
CREDIT_CRITICAL_THRESHOLD=50
CREDIT_MONITORING_INTERVAL=5

# =============================================================================
# üì± SMS CONFIGURATION - PRODUCTION
# =============================================================================

# SMS Deployment Strategy
SMS_DEPLOYMENT_REGION=egypt
SMS_FALLBACK_ENABLED=true
SMS_DOMESTIC_PROVIDER=vodafone
SMS_INTERNATIONAL_PROVIDER=twilio

# Vodafone SMS (Production - GET FROM VODAFONE)
VODAFONE_SMS_USERNAME=YOUR_VODAFONE_USERNAME
VODAFONE_SMS_PASSWORD=YOUR_VODAFONE_PASSWORD
VODAFONE_SMS_CUSTOMER_ID=YOUR_VODAFONE_CUSTOMER_ID
VODAFONE_SMS_SENDER_ADDRESS=LIFEBOX
VODAFONE_SMS_BASE_URL=https://api.messaging.vodafone.com
VODAFONE_SMS_NOTIFY_URL=https://your-domain.com/api/v1/notifications/vodafone/callback

# Twilio SMS (Production - GET FROM TWILIO)
TWILIO_ACCOUNT_SID=YOUR_TWILIO_ACCOUNT_SID
TWILIO_AUTH_TOKEN=YOUR_TWILIO_AUTH_TOKEN
TWILIO_PHONE_NUMBER=YOUR_TWILIO_PHONE_NUMBER

# =============================================================================
# üìß EMAIL CONFIGURATION - PRODUCTION
# =============================================================================

# Production SMTP Configuration
SMTP_HOST="smtp.your-email-provider.com"
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER="your-smtp-username"
SMTP_PASS="your-smtp-password"
SMTP_FROM="LifeBox System <noreply@your-domain.com>"
EMAIL_FROM="noreply@your-domain.com"

# Optional: SendGrid for better deliverability
SENDGRID_API_KEY=YOUR_SENDGRID_API_KEY

# =============================================================================
# üìÅ FILE STORAGE & PATHS - PRODUCTION
# =============================================================================

REPORTS_PATH="/app/data/reports"
UPLOADS_PATH="/app/data/uploads"
TEMP_PATH="/app/data/temp"
MAX_FILE_SIZE=52428800
UPLOAD_DIR="/app/uploads"
REPORT_TEMPLATE_PATH="/app/templates/reports"
REPORT_OUTPUT_PATH="/app/data/generated-reports"
UPLOAD_ALLOWED_TYPES="jpg,jpeg,png,pdf,doc,docx,txt,csv"
UPLOAD_MAX_FILES=10

# =============================================================================
# üîß PRODUCTION OPTIMIZATIONS
# =============================================================================

# Logging Configuration
LOG_LEVEL="info"
SENTRY_DSN="YOUR_SENTRY_DSN_FOR_ERROR_TRACKING"

# Rate Limiting (Production)
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# Database Connection Pool
DATABASE_POOL_SIZE=10
DATABASE_MAX_CONNECTIONS=50
DATABASE_CONNECTION_TIMEOUT=10000
DATABASE_LOGGING=false
DATABASE_SLOW_QUERY_THRESHOLD=2000

# MQTT Connection Pool
MQTT_RECONNECT_PERIOD=5000
MQTT_KEEP_ALIVE=60
MQTT_CLEAN_SESSION=true
MQTT_DEBUG=false
MQTT_LOG_PACKETS=false

# Cache Configuration (Production Redis)
REDIS_URL="redis://localhost:6379"
REDIS_PASSWORD="STRONG_REDIS_PASSWORD"

# =============================================================================
# üîî NOTIFICATION SETTINGS - PRODUCTION
# =============================================================================

# Feature Flags
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_SMS_NOTIFICATIONS=true
ENABLE_AUTO_DEVICE_SHUTDOWN=true
ENABLE_AUTO_DEVICE_REACTIVATION=true
ENABLE_PAYMENT_RECONCILIATION=true

# Alarm Configuration
ALARM_EMAIL_ENABLED=true
ALARM_SMS_ENABLED=true
ALARM_COOLDOWN_MINUTES=5

# Notification Settings
NOTIFICATION_QUEUE_SIZE=10000
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_RETRY_DELAY=5000

# Email Settings
EMAIL_PREVIEW=false
EMAIL_SEND_REAL=true

# SMS Settings
SMS_MOCK_MODE=false
SMS_LOG_MESSAGES=true

# =============================================================================
# üåê TIMEZONE & LOCALIZATION
# =============================================================================

TZ="Africa/Cairo"

# =============================================================================
# üìä MONITORING & HEALTH CHECKS - PRODUCTION
# =============================================================================

# Health Check Settings
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_MQTT=true
HEALTH_CHECK_REDIS=true

# Performance Settings
ENABLE_COMPRESSION=true
ENABLE_CORS=false
CORS_ORIGIN="https://your-domain.com"

# WebSocket Settings
WS_HEARTBEAT_INTERVAL=30000
WS_CONNECTION_TIMEOUT=60000

# Report Generation
REPORT_GENERATION_TIMEOUT=60000
REPORT_MAX_CONCURRENT=5

# Cron Job Settings
CRON_CLEANUP_ENABLED=true
CRON_CLEANUP_SCHEDULE="0 2 * * *"
CRON_BACKUP_ENABLED=true

# Development Tools (Disable in production)
ENABLE_SWAGGER=false
ENABLE_DEBUG_ROUTES=false
ENABLE_ADMIN_PANEL=false

# System User
SYSTEM_USER_EMAIL="system@your-domain.com"
SYSTEM_USER_ID="system"

# =============================================================================
# üè¢ CLIENT INTEGRATION SETTINGS - PRODUCTION
# =============================================================================

# MQTT Broker Details (Share with IoT device manufacturers)
COMPANY_MQTT_HOST=your-domain.com
COMPANY_MQTT_PORT=1883
COMPANY_MQTT_TLS=true
COMPANY_MQTT_CERT_VALIDATION=true

# API Endpoints (Share with integration partners)
COMPANY_API_BASE=https://your-domain.com/api/v1
COMPANY_WEBSOCKET_URL=wss://your-domain.com

# Device Registration Endpoint
DEVICE_REGISTRATION_ENDPOINT=https://your-domain.com/api/v1/devices

# Telemetry Endpoint (HTTP fallback)
TELEMETRY_HTTP_ENDPOINT=https://your-domain.com/api/v1/devices/{deviceId}/telemetry

# =============================================================================
# üìã DEPLOYMENT NOTES
# =============================================================================
#
# 1. Replace ALL placeholder values with actual production values
# 2. Generate strong random secrets for JWT, session, and API tokens
# 3. Configure SSL certificates for HTTPS
# 4. Set up proper firewall rules on your VPS
# 5. Configure backup strategies for database and files
# 6. Set up monitoring and alerting
# 7. Test all integrations before going live
# 8. Keep this file secure and never commit to version control
#
# For complete deployment guide, see: docs/DEPLOYMENT.md
# =============================================================================